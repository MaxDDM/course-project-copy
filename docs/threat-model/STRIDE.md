<table>
<thead>
<tr>
<th>Поток/Элемент</th>
<th>Угроза (STRIDE)</th>
<th>Риск</th>
<th>Контроль</th>
<th>Ссылка на NFR</th>
<th>Проверка/артефакт</th>
</tr>
</thead>
<tbody><tr>
<td>F1: HTTP/HTTPS запросы от клиента к API Gateway</td>
<td>Spoofing</td>
<td>R3</td>
<td>High. MFA и базовый rate-limiting на входящие запросы; валидация токенов</td>
<td>NFR-04</td>
<td>Валидация входящих данных; тесты контрактов; линтеры/сканеры на токены и подписи</td>
</tr>
<tr>
<td>F2: Запись/чтение тренировок</td>
<td>Tampering</td>
<td>R2</td>
<td>Medium. Применение МD5/SHA-256 хэширования для критичных полей, ACL на доступ к DB, транзакции</td>
<td>NFR-02, NFR-06</td>
<td>Контрактные тесты, аудиты доступа, тесты на целостность данных</td>
</tr>
<tr>
<td>F3: Чтение тренировок</td>
<td>Information Disclosure</td>
<td>R2</td>
<td>High. Проверка прав доступа перед чтением; минимизация возвращаемых полей</td>
<td>NFR-06</td>
<td>Тесты с негативными сценариями доступа; аудит журналов</td>
</tr>
<tr>
<td>F4: Чтение/запись подходов</td>
<td>Tampering / Replay: повторная отправка старых подходов</td>
<td>R8</td>
<td>High. GUID/ID уникальность; валидация payload; проверки соответствия workout_id</td>
<td>NFR-04</td>
<td>Контрактные тесты; тесты на повторную отправку; мониторинг уникальности ID</td>
</tr>
<tr>
<td>F5: Чтение подходов</td>
<td>Information Disclosure</td>
<td>R4</td>
<td>Medium. Корректная обработка ошибок; не выдавать PII</td>
<td>NFR-06</td>
<td>Тесты на корректные форматы ошибок; журналирование без PII</td>
</tr>
<tr>
<td>F6: Ответ клиенту</td>
<td>Elevation of Privilege</td>
<td>R5</td>
<td>Medium. Валидации входных параметров; исключение некорректного потока</td>
<td>NFR-04</td>
<td>Юнит/интеграционные тесты на валидацию входа</td></tr>
<tr>
<td>F6: Ответы API Gateway клиенту</td>
<td>Elevation of Privilege</td>
<td>R5</td>
<td>High. Валидация ролей/права доступа на уровне API Gateway; сигнатуры и контроли доступа на уровне сервиса</td>
<td>NFR-04, NFR-06</td>
<td>Тесты на привилегии, аудит доступа, проверка подписи токенов</td>
</tr>

<tr>
<td>F3, F6: Удаление тренировок и связанных подходов</td>
<td>Tampering / Information Disclosure</td>
<td>R9</td>
<td>Medium. Подтверждение целостности операций удаления; аудит действий удаления; минимизация раскрытия информации об удалении</td>
<td>NFR-04</td>
<td>Контрактные тесты, аудит журналов доступа, тесты на корректность удаления</td>
</tr>
</tbody></table>
